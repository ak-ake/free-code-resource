<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Redirecting...</title>
    <meta http-equiv="refresh" content="5">
    <script>
        // Robust clean-URL redirect for GitHub Pages
        // Tries several candidate paths and redirects to the first that exists.
        (function () {
            const path = window.location.pathname;

            // Determine repository base (e.g. '/free-code-resource') or '' for user root
            const parts = path.split('/');
            const repoBase = parts.length > 1 && parts[1] ? '/' + parts[1] : '';

            // Relative part after repo base
            let rel = path.slice(repoBase.length) || '/';

            // If requested URL already contains .html, redirect to clean version
            if (rel.endsWith('.html')) {
                const clean = repoBase + rel.replace(/\.html$/, '/') ;
                window.location.replace(clean + window.location.search + window.location.hash);
                return;
            }

            // Normalize rel so it starts with '/'
            if (!rel.startsWith('/')) rel = '/' + rel;

            // Build candidate URLs to test (in order)
            const candidates = [];

            // 1) Direct mapping: /{repo}{rel}.html  (e.g. /free-code-resource/assets/pages/codes.html)
            if (rel === '/' ) {
                candidates.push(repoBase + '/index.html');
            } else {
                candidates.push(repoBase + rel.replace(/\/$/, '') + '.html');
            }

            // 2) Try mapping into /assets/pages if not already there
            if (!rel.startsWith('/assets')) {
                if (rel === '/') candidates.push(repoBase + '/assets/pages/index.html');
                else candidates.push(repoBase + '/assets/pages' + rel.replace(/\/$/, '') + '.html');
            }

            // 3) Try with trailing index.html (for paths like /foo/ -> /foo/index.html)
            if (!rel.endsWith('/')) {
                candidates.push(repoBase + rel + '/index.html');
            } else {
                candidates.push(repoBase + rel + 'index.html');
            }

            // Remove duplicates while preserving order
            const seen = new Set();
            const uniq = candidates.filter((c) => {
                if (seen.has(c)) return false;
                seen.add(c);
                return true;
            });

            // Try each candidate with HEAD request; on success redirect
            let i = 0;
            function tryNext() {
                if (i >= uniq.length) return; // nothing found
                const url = uniq[i++];
                fetch(url, { method: 'HEAD', cache: 'no-store' })
                    .then((r) => {
                        if (r && r.ok) {
                            window.location.replace(url + window.location.search + window.location.hash);
                        } else {
                            tryNext();
                        }
                    })
                    .catch(() => tryNext());
            }

            tryNext();
        })();
    </script>
</head>
<body>
    <p>Redirectingâ€¦ If you are not redirected automatically, try the full URL in your browser.</p>
</body>
</html>
